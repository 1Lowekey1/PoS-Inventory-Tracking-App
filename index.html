<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Booth POS - Offline Cashier System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="nav-bar">
        <button class="nav-btn active" data-screen="cashier">
            <span class="nav-icon">üí∞</span>
            <span class="nav-label">Cashier</span>
        </button>
        <button class="nav-btn" data-screen="products">
            <span class="nav-icon">üìã</span>
            <span class="nav-label">Products</span>
        </button>
        <button class="nav-btn" data-screen="inventory">
            <span class="nav-icon">üì¶</span>
            <span class="nav-label">Inventory</span>
        </button>
        <button class="nav-btn" data-screen="reports">
            <span class="nav-icon">üìä</span>
            <span class="nav-label">Reports</span>
        </button>
        <button class="nav-btn" data-screen="settings">
            <span class="nav-icon">‚öôÔ∏è</span>
            <span class="nav-label">Settings</span>
        </button>
    </nav>

    <!-- Demo Mode Indicator -->
    <div class="demo-indicator" id="demo-indicator" style="display: none;">
        üß™ DEMO MODE - Sales won't affect real inventory
    </div>

    <!-- Screen: Cashier -->
    <div class="screen active" id="cashier-screen">
        <!-- Event Status Banner -->
        <div class="event-banner" id="event-banner" style="display: none;">
            <div class="event-banner-content">
                <span class="event-status-dot"></span>
                <span class="event-text" id="event-text">No Active Event</span>
            </div>
            <button class="event-action-btn" id="event-action-btn">Start Event</button>
        </div>

        <div class="screen-header">
            <h1>Cashier</h1>
            <div class="header-stats">
                <div class="stat-box">
                    <span class="stat-label">Sales Today</span>
                    <span class="stat-value" id="total-sales">‚Ç±0.00</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Items Sold</span>
                    <span class="stat-value" id="items-sold">0</span>
                </div>
            </div>
        </div>

        <!-- Planned Output Progress (shown only when active event has planned output) -->
        <div id="planned-output-progress" style="display: none;"></div>
        
        <div class="product-grid" id="product-grid">
            <!-- Product buttons will be dynamically generated -->
            <div class="empty-state">
                <p>No active products</p>
                <p class="empty-hint">Add products in the Products tab</p>
            </div>
        </div>

        <div class="cashier-actions">
            <button class="action-btn secondary" id="undo-sale-btn" disabled>
                <span>‚Ü∂</span> Undo Last Sale
            </button>
        </div>
    </div>

    <!-- Screen: Products -->
    <div class="screen" id="products-screen">
        <div class="screen-header">
            <h1>Products</h1>
            <button class="btn-primary" id="add-product-btn">+ New Product</button>
        </div>

        <div class="product-list" id="product-list">
            <!-- Product cards will be dynamically generated -->
            <div class="empty-state">
                <p>No products yet</p>
                <p class="empty-hint">Create your first product</p>
            </div>
        </div>
    </div>

    <!-- Screen: Inventory -->
    <div class="screen" id="inventory-screen">
        <div class="screen-header">
            <h1>Inventory</h1>
            <div class="inventory-header-actions">
                <button class="btn-secondary" id="restock-low-btn" style="display: none;">
                    üì¶ Restock Low Items
                </button>
                <button class="btn-primary" id="add-ingredient-btn">+ New Ingredient</button>
            </div>
        </div>

        <div class="ingredient-list" id="ingredient-list">
            <!-- Ingredient cards will be dynamically generated -->
            <div class="empty-state">
                <p>No ingredients yet</p>
                <p class="empty-hint">Add your first ingredient</p>
            </div>
        </div>
    </div>

    <!-- Screen: Reports -->
    <div class="screen" id="reports-screen">
        <div class="screen-header">
            <h1>Reports</h1>
            <div class="report-actions">
                <button class="btn-secondary" id="export-data-btn">üíæ Backup Data</button>
                <button class="btn-danger" id="reset-event-btn">üîÑ Reset Event</button>
            </div>
        </div>

        <div class="report-container">
            <div class="report-section">
                <h2>Financial Summary</h2>
                <div class="report-stats">
                    <div class="report-stat-card">
                        <span class="report-label">Total Revenue</span>
                        <span class="report-value" id="report-revenue">‚Ç±0.00</span>
                    </div>
                    <div class="report-stat-card">
                        <span class="report-label">Fixed Event Cost</span>
                        <span class="report-value" id="report-fixed-cost">‚Ç±0.00</span>
                        <small style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">One-time upfront cost</small>
                    </div>
                    <div class="report-stat-card success" id="profit-card">
                        <span class="report-label">Net Profit/Loss</span>
                        <span class="report-value" id="report-profit">‚Ç±0.00</span>
                        <small style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">Revenue - Fixed Cost</small>
                    </div>
                    <div class="report-stat-card">
                        <span class="report-label">Items Sold</span>
                        <span class="report-value" id="report-items">0</span>
                    </div>
                </div>
            </div>

            <div class="report-section">
                <h2>Sales by Product</h2>
                <div class="sales-breakdown" id="sales-breakdown">
                    <p class="empty-hint">No sales yet</p>
                </div>
            </div>

            <div class="report-section">
                <h2>Recent Transactions</h2>
                <div class="transaction-list" id="transaction-list">
                    <p class="empty-hint">No transactions yet</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Screen: Settings -->
    <div class="screen" id="settings-screen">
        <div class="screen-header">
            <h1>Settings</h1>
        </div>

        <div class="settings-container">
            <div class="settings-section">
                <h2>Appearance</h2>
                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Theme</span>
                        <span class="setting-description">Choose your preferred color scheme</span>
                    </div>
                    <select id="theme-select" class="setting-select">
                        <option value="auto">üåó Auto (System)</option>
                        <option value="light">‚òÄÔ∏è Light</option>
                        <option value="dark">üåô Dark</option>
                    </select>
                </div>
                
                <div style="margin-top: var(--spacing-md); padding: var(--spacing-md); background: var(--surface); border-radius: var(--border-radius); border: 2px solid var(--border);">
                    <p style="font-size: var(--font-size-sm); color: var(--text-secondary);">
                        <strong>Auto:</strong> Matches your device's system theme preference.<br>
                        <strong>Light/Dark:</strong> Always use that theme regardless of system settings.
                    </p>
                </div>
            </div>

            <div class="settings-section">
                <h2>Testing & Demo</h2>
                <div class="setting-item">
                    <div class="setting-info">
                        <span class="setting-label">Demo Mode</span>
                        <span class="setting-description">Test sales without affecting real inventory</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="demo-mode-toggle">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div style="margin-top: var(--spacing-md); padding: var(--spacing-md); background: #fef3c7; border-radius: var(--border-radius); border-left: 4px solid var(--warning);">
                    <p style="font-size: var(--font-size-sm); margin-bottom: var(--spacing-sm);">
                        <strong>Demo Mode:</strong> Sales are tracked for testing but inventory is NOT affected. Perfect for training or testing pricing.
                    </p>
                    <button class="btn-secondary" id="clear-demo-sales-btn" style="width: 100%;">
                        Clear Demo Sales
                    </button>
                </div>
            </div>

            <div class="settings-section">
                <h2>About</h2>
                <div class="about-info">
                    <p><strong>Booth POS</strong></p>
                    <p>Version 2.0 - Offline Cashier System</p>
                    <p style="margin-top: 1rem; color: var(--text-secondary); font-size: 0.875rem;">
                        Designed for food & beverage booths, pop-ups, and events.
                        All data stored locally on your device.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Add/Edit Ingredient -->
    <div class="modal" id="ingredient-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="ingredient-modal-title">Add Ingredient</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="ingredient-form">
                <input type="hidden" id="ingredient-id">
                
                <div class="form-group">
                    <label>Ingredient Name *</label>
                    <input type="text" id="ingredient-name" required placeholder="e.g., Coffee, Milk, Cup">
                </div>

                <div class="form-group">
                    <label>Unit *</label>
                    <select id="ingredient-unit" required>
                        <option value="">Select unit</option>
                        <option value="grams">Grams (g)</option>
                        <option value="ml">Milliliters (ml)</option>
                        <option value="pcs">Pieces (pcs)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Starting Quantity *</label>
                    <input type="number" id="ingredient-total-quantity" step="0.01" min="0" required placeholder="e.g., 1000">
                    <small style="color: var(--text-secondary); font-size: 0.75rem;">How much you have for the event</small>
                </div>

                <div class="form-group">
                    <label>Low Stock Alert</label>
                    <input type="number" id="ingredient-threshold" step="0.01" min="0" placeholder="10">
                    <small style="color: var(--text-secondary); font-size: 0.75rem;">Alert when quantity falls below this</small>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn-primary">Save Ingredient</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Add/Edit Product -->
    <div class="modal" id="product-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="product-modal-title">Add Product</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="product-form">
                <input type="hidden" id="product-id">
                
                <div class="form-group">
                    <label>Product Name *</label>
                    <input type="text" id="product-name" required placeholder="e.g., Iced Latte">
                </div>

                <div class="form-group">
                    <label>Selling Price (‚Ç±) *</label>
                    <input type="number" id="product-price" step="0.01" min="0" required placeholder="0.00">
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="product-active" checked>
                        <span>Active (available for sale)</span>
                    </label>
                </div>

                <div class="form-group">
                    <label>Recipe (Ingredients) *</label>
                    <div id="recipe-builder">
                        <!-- Recipe items will be added here -->
                    </div>
                    <button type="button" class="btn-secondary" id="add-recipe-item-btn">+ Add Ingredient</button>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn-primary">Save Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Confirmation -->
    <div class="modal" id="confirm-modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2 id="confirm-title">Confirm</h2>
            </div>
            <div class="modal-body">
                <p id="confirm-message"></p>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="confirm-cancel">Cancel</button>
                <button class="btn-danger" id="confirm-ok">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Modal: Event Costs -->
    <div class="modal" id="event-costs-modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Set Event Costs</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="event-costs-form">
                <div class="form-group">
                    <label>Total Fixed Cost (‚Ç±) *</label>
                    <input type="number" id="fixed-cost" step="0.01" min="0" required placeholder="e.g., 1500.00">
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.5rem; display: block;">
                        This is the TOTAL you paid upfront for ALL ingredients (coffee, milk, cups, etc.). This is a one-time sunk cost.
                    </small>
                </div>

                <div class="form-group">
                    <label>Notes (Optional)</label>
                    <textarea id="cost-notes" rows="3" placeholder="e.g., 500g coffee + 1L milk + 50 cups" style="width: 100%; padding: var(--spacing-sm); border: 2px solid var(--border); border-radius: var(--border-radius); font-family: inherit; font-size: var(--font-size-md);"></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Start Event -->
    <div class="modal" id="start-event-modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Start New Event</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="start-event-form">
                <!-- FIXED: Added missing event-name field -->
                <div class="form-group">
                    <label>Event Name *</label>
                    <input type="text" id="event-name" required placeholder="e.g., Weekend Market, School Fair">
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.5rem; display: block;">
                        Give your event a memorable name
                    </small>
                </div>

                <div class="form-group">
                    <label>Fixed Event Cost (‚Ç±) *</label>
                    <input type="number" id="event-fixed-cost" step="0.01" min="0" required placeholder="1500.00">
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.5rem; display: block;">
                        Total upfront cost for ALL ingredients
                    </small>
                </div>

                <div class="form-group">
                    <label>Planned Output (Optional)</label>
                    <input type="number" id="event-planned-output" step="1" min="0" placeholder="50">
                    <small style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 0.5rem; display: block;">
                        How many items do you plan to sell? (for break-even estimate only)
                    </small>
                </div>

                <!-- Break-even calculation display -->
                <div id="break-even-calc"></div>

                <div class="form-group">
                    <label>Notes (Optional)</label>
                    <textarea id="event-notes" rows="2" placeholder="Event location, special notes, etc." style="width: 100%; padding: var(--spacing-sm); border: 2px solid var(--border); border-radius: var(--border-radius); font-family: inherit; font-size: var(--font-size-md);"></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn-primary">Start Event</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: End Event -->
    <div class="modal" id="end-event-modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>End Event</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to end the current event?</p>
                <p style="margin-top: 1rem; color: var(--text-secondary); font-size: 0.875rem;">
                    This will lock the sales and show final results. You can start a new event afterwards.
                </p>
                <div id="end-event-summary" style="margin-top: 1rem; padding: var(--spacing-md); background: var(--background); border-radius: var(--border-radius);"></div>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="end-event-cancel">Cancel</button>
                <button class="btn-danger" id="end-event-confirm">End Event</button>
            </div>
        </div>
    </div>

    <!-- Modal: Batch Sale -->
    <div class="modal" id="batch-sale-modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2 id="batch-sale-title">Batch Sale</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="batch-sale-product-info">
                    <div style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem;" id="batch-product-name"></div>
                    <div style="font-size: 1.5rem; font-weight: 800; color: var(--primary);" id="batch-product-price"></div>
                </div>

                <div class="form-group" style="margin-top: var(--spacing-lg);">
                    <label>Quantity *</label>
                    <input type="number" id="batch-quantity" min="1" value="1" step="1" required 
                           style="width: 100%; padding: var(--spacing-md); font-size: 1.25rem; text-align: center; border: 2px solid var(--border); border-radius: var(--border-radius);">
                </div>

                <div id="batch-total" style="margin-top: var(--spacing-md); padding: var(--spacing-md); background: var(--background); border-radius: var(--border-radius); text-align: center;">
                    <div style="color: var(--text-secondary); font-size: 0.875rem;">Total</div>
                    <div style="font-size: 2rem; font-weight: 800; color: var(--primary);" id="batch-total-amount">‚Ç±0.00</div>
                </div>

                <div id="batch-warnings" style="margin-top: var(--spacing-md);"></div>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary modal-cancel">Cancel</button>
                <button class="btn-primary" id="batch-sale-confirm">Confirm Sale</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toast-container"></div>

    <script src="app.js"></script>
</body>
</html>